(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{384:function(t,e,i){"use strict";i.r(e);i(37),i(28),i(38),i(39),i(40),i(41),i(42),i(43),i(44),i(15);function n(t,e){var i;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return a(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return a(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,s=function(){};return{s:s,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,r=!0,c=!1;return{s:function(){i=t[Symbol.iterator]()},n:function(){var t=i.next();return r=t.done,t},e:function(t){c=!0,o=t},f:function(){try{r||null==i.return||i.return()}finally{if(c)throw o}}}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var s={name:"scrolling-collection",components:{MediaCard:i(405).a},props:{collection:Array,active:String},watch:{collection:function(){this.$nextTick((function(){var t,e=n(this.$refs.media);try{for(e.s();!(t=e.n()).done;){var i=t.value;if(i.$props.active){this.$el.scrollLeft=i.$el.getBoundingClientRect().left-this.$el.getBoundingClientRect().left;break}}}catch(t){e.e(t)}finally{e.f()}}))}}},o=(i(441),i(2)),r=Object(o.a)(s,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"collection row mb-2"},t._l(t.collection,(function(e){return i("div",{key:e.media_id,staticClass:"col-lg-3 col-md-4 col-sm-6 offset-sm-0 col-8 offset-2"},[i("media-card",{ref:"media",refInFor:!0,attrs:{media:e,active:e.media_id==t.active}})],1)})),0)}),[],!1,null,"c5b4895a",null).exports,c=(i(377),{name:"toogle-watched-button",components:{Loading:i(395).a},props:{mediaId:String,playhead:Number,duration:Number},computed:{watched:function(){return this.playhead>=.9*this.duration}},methods:{toggleWatched:function(){var t=this;this.loading=!0,this.$store.dispatch("media/setWatched",{mediaId:this.mediaId,watched:!this.watched,duration:this.duration}).then((function(){t.$emit("toggle",t.endLoading)}))},endLoading:function(){this.loading=!1}},data:function(){return{loading:!1}}}),d={name:"media",mounted:function(){this.$store.dispatch("media/getMedia",this.mediaId)},computed:{media:function(){return this.$store.state.media.currentMedia},mediaId:function(){return this.$route.params.id},collection:function(){return this.$store.state.media.collection},locale:function(){return this.$store.state.locale.locale},lastMedia:function(){for(var t=0;t<this.collection.length;t++)if(this.collection[t].media_id===this.mediaId&&t-1>=0)return this.collection[t-1];return null},nextMedia:function(){for(var t=0;t<this.collection.length;t++)if(this.collection[t].media_id===this.mediaId&&t+1<this.collection.length)return this.collection[t+1];return null}},components:{ScrollingCollection:r,ToggleWatchedButton:Object(o.a)(c,(function(){var t=this.$createElement,e=this._self._c||t;return this.loading?e("button",{staticClass:"btn btn-disabled btn-sm"},[e("loading")],1):e("button",{staticClass:"btn btn-primary btn-sm",on:{click:this.toggleWatched}},[this._v(this._s(this.watched?this.$t("media.markUnwatched"):this.$t("media.markWatched")))])}),[],!1,null,null,null).exports,ToggleQueueButton:i(421).a},watch:{mediaId:function(){this.$store.dispatch("media/getMedia",this.mediaId)},media:function(){document.title="".concat(this.$t("media.episode",{number:this.media.episode_number}),": ").concat(this.media.name," - ").concat(this.media.collection_name," ― CR"),this.$store.dispatch("media/getCollection",this.media.collection_id)},locale:function(){this.$store.dispatch("media/getMedia",this.mediaId)}},methods:{onToggleWatched:function(t){this.$store.dispatch("media/getMedia",this.mediaId).then((function(){t()}))},onQueueToggle:function(t){this.$store.dispatch("media/getMedia",this.mediaId).then((function(){t()}))}}},l=(i(442),Object(o.a)(d,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.media?i("div",[i("div",{staticClass:"embed-responsive embed-responsive-16by9"},[i("div",{staticClass:"embed-responsive-item"},[i("iframe",{attrs:{src:"/player/"+t.media.media_id,width:"100%",height:"100%",frameborder:"0",scrolling:"no",allowfullscreen:""}})])]),t._v(" "),t.media.media_id===t.mediaId?i("div",{staticClass:"content-box"},[i("div",{staticClass:"clearfix"},[t.lastMedia?i("router-link",{staticClass:"btn btn-primary mb-2",attrs:{to:"/media/"+t.lastMedia.media_id}},[i("fa-icon",{attrs:{icon:"chevron-left"}}),t._v(" "+t._s(t.$t("media.episode",{number:t.lastMedia.episode_number})))],1):i("span",{staticClass:"btn btn-disabled mb-2"},[i("fa-icon",{attrs:{icon:"chevron-left"}})],1),t._v(" "),t.nextMedia?i("router-link",{staticClass:"btn btn-primary float-right mb-2",attrs:{to:"/media/"+t.nextMedia.media_id}},[t._v(t._s(t.$t("media.episode",{number:t.nextMedia.episode_number}))+" "),i("fa-icon",{attrs:{icon:"chevron-right"}})],1):i("span",{staticClass:"btn btn-disabled float-right mb-2"},[i("fa-icon",{attrs:{icon:"chevron-right"}})],1)],1),t._v(" "),i("h1",{staticClass:"text-light title"},[t._v(t._s(t.media.name))]),t._v(" "),i("h2",{staticClass:"text-light sub-title"},[i("router-link",{staticClass:"text-primary",attrs:{to:"/series/"+t.media.series_id}},[t._v(t._s(t.media.collection_name))]),t._v(" - "+t._s(t.$t("media.episode",{number:t.media.episode_number})))],1),t._v(" "),i("p",{staticClass:"text-light"},[t._v(t._s(t.media.description))]),t._v(" "),i("toggle-watched-button",{attrs:{mediaId:t.media.media_id,playhead:t.media.playhead,duration:t.media.duration},on:{toggle:t.onToggleWatched}}),t._v(" "),i("toggle-queue-button",{attrs:{seriesId:t.media.series_id,inQueue:t.media.in_queue},on:{toggle:t.onQueueToggle}})],1):i("div",{staticClass:"content-box"},[i("div",{staticClass:"clearfix"},[i("span",{staticClass:"btn btn-disabled mb-2"},[i("fa-icon",{attrs:{icon:"chevron-left"}})],1),t._v(" "),i("span",{staticClass:"btn btn-disabled float-right mb-2"},[i("fa-icon",{attrs:{icon:"chevron-right"}})],1)]),t._v(" "),i("loading")],1),t._v(" "),i("scrolling-collection",{attrs:{collection:t.collection,active:t.media.media_id}})],1):i("loading")}),[],!1,null,"1ebc6908",null));e.default=l.exports},395:function(t,e,i){"use strict";var n={name:"loading",data:function(){return{count:5}}},a=(i(398),i(2)),s=Object(a.a)(n,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"spinner"},this._l(this.count,(function(t){return e("div",{key:t,class:"rect rect"+t})})),0)}),[],!1,null,"597d1897",null);e.a=s.exports},396:function(t,e,i){},397:function(t,e,i){},398:function(t,e,i){"use strict";i(396)},399:function(t,e,i){"use strict";var n={name:"card"},a=(i(400),i(2)),s=Object(a.a)(n,(function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"card bg-dark text-light"},[this._t("default")],2)}),[],!1,null,"2edc5dc4",null);e.a=s.exports},400:function(t,e,i){"use strict";i(397)},401:function(t,e,i){},402:function(t,e,i){"use strict";var n=i(1);e.a=new n.a},403:function(t,e,i){},404:function(t,e,i){"use strict";i(377);var n={name:"progress-bar",props:{value:Number}},a=i(2),s=Object(a.a)(n,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"progress rounded-0 bg-warning",staticStyle:{height:"4px"}},[e("div",{staticClass:"progress-bar bg-primary",style:{width:this.value+"%"},attrs:{role:"progressbar","aria-valuenow":this.value,"aria-valuemin":"0","aria-valuemax":"100"}})])}),[],!1,null,null,null);e.a=s.exports},405:function(t,e,i){"use strict";i(380),i(311);var n=i(404),a=i(399),s=(i(20),i(15),i(21),i(378),i(377),i(1)),o=i(379),r=i.n(o);function c(t,e,i,n,a,s,o){try{var r=t[s](o),c=r.value}catch(t){return void i(t)}r.done?e(c):Promise.resolve(c).then(n,a)}function d(t){return function(){var e=this,i=arguments;return new Promise((function(n,a){var s=t.apply(e,i);function o(t){c(s,n,a,o,r,"next",t)}function r(t){c(s,n,a,o,r,"throw",t)}o(void 0)}))}}s.a.use(r.a);var l={name:"media-card-context",props:{value:Boolean,position:{x:Number,y:Number},mediaId:String,seriesId:String,watched:Boolean,duration:Number},computed:{inQueue:function(){var t=this;return void 0!==this.$store.state.queue.queue.find((function(e){return e.series.series_id===t.seriesId}))}},methods:{close:function(){this.$emit("input",!1)},toggleWatched:function(){var t=this;return d(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.close(),t.$emit("beginUpdate"),e.next=4,t.$store.dispatch("media/setWatched",{mediaId:t.mediaId,watched:!t.watched,duration:t.duration});case 4:return e.next=6,t.$store.dispatch("media/updateMedia",t.mediaId);case 6:t.$emit("updated");case 7:case"end":return e.stop()}}),e)})))()},toggleQueue:function(){var t=this;return d(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.close(),t.$emit("beginUpdate"),e.next=4,t.$store.dispatch("media/toggleQueue",{seriesId:t.seriesId,inQueue:t.inQueue});case 4:return e.next=6,t.$store.dispatch("media/updateSeries",t.seriesId);case 6:return e.next=8,t.$store.dispatch("queue/getQueue");case 8:t.$emit("updated");case 9:case"end":return e.stop()}}),e)})))()}}},u=(i(406),i(2)),m=Object(u.a)(l,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.value?i("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:t.close,expression:"close"}],staticClass:"list-group position-absolute text-nowrap",style:{left:t.position.x+"px",top:t.position.y+"px"}},[i("a",{staticClass:"list-group-item list-group-item-action bg-dark text-light",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.toggleWatched(e)}}},[t._v("\n    "+t._s(t.watched?t.$t("media.markUnwatched"):t.$t("media.markWatched"))+"\n  ")]),t._v(" "),i("a",{staticClass:"list-group-item list-group-item-action bg-dark text-light",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.toggleQueue(e)}}},[t._v("\n    "+t._s(t.inQueue?t.$t("media.queueRemove"):t.$t("media.queueAdd"))+"\n  ")])]):t._e()}),[],!1,null,"3b8ea60a",null).exports,h=i(395),f=i(402),g={name:"media-card",props:{media:Object,active:Boolean},data:function(){return{showContextMenu:!1,contextMenuPosition:{x:0,y:0},loading:!1,cardHeight:0}},components:{ProgressBar:n.a,Card:a.a,MediaCardContext:m,Loading:h.a},created:function(){var t=this;f.a.$on("closeContextMenus",(function(){t.showContextMenu=!1}))},methods:{contextMenu:function(t){f.a.$emit("closeContextMenus"),this.showContextMenu=!0,this.contextMenuPosition.x=t.clientX-this.$refs.card.$el.getBoundingClientRect().left,this.contextMenuPosition.y=t.clientY-this.$refs.card.$el.getBoundingClientRect().top},mediaUpdated:function(){this.loading=!1},mediaBeginUpdate:function(){this.cardHeight=this.$refs.card.$el.getBoundingClientRect().height,this.loading=!0}},computed:{length:function(){return new Date(1e3*this.media.duration).toISOString().substr(11,8).replace(/^(00:)?0?/,"")},watchedTime:function(){return new Date(1e3*this.media.playhead).toISOString().substr(11,8).replace(/^(00:)?0?/,"")},watched:function(){return this.media.playhead>=.9*this.media.duration}}},p=(i(407),Object(u.a)(g,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t.loading?i("card",{class:{"active-card":t.active},style:{height:t.cardHeight+"px"}},[i("loading",{staticClass:"my-auto"})],1):i("card",{ref:"card",class:{"active-card":t.active},nativeOn:{contextmenu:function(e){return e.preventDefault(),e.stopPropagation(),t.contextMenu(e)}}},[i("router-link",{staticClass:"text-reset embed-responsive embed-responsive-16by9",attrs:{to:"/media/"+t.media.media_id}},[t.media.screenshot_image?i("img",{staticClass:"card-img-top embed-responsive-item image",attrs:{src:t.$https(t.media.screenshot_image.large_url),alt:"Media Thumbnail"}}):t._e(),t._v(" "),i("div",{staticClass:"play"}),t._v(" "),t.watched?i("div",{staticClass:"watched-grey"}):t._e(),t._v(" "),t.watched?i("fa-icon",{staticClass:"watched",attrs:{icon:"eye"}}):t._e(),t._v(" "),i("span",{staticClass:"badge badge-secondary length"},[t._v(t._s(t.media.playhead>0&&!t.watched?t.watchedTime+" / ":"")+t._s(t.length))])],1),t._v(" "),i("progress-bar",{attrs:{value:t.media.playhead/t.media.duration*100}}),t._v(" "),i("div",{staticClass:"mx-2 my-1 d-flex flex-column"},[i("span",{staticClass:"text-truncate"},[i("router-link",{staticClass:"text-reset",attrs:{to:"/series/"+t.media.series_id,title:t.media.collection_name}},[t._v("\n          "+t._s(t.media.collection_name)+"\n        ")])],1),t._v(" "),i("small",{staticClass:"text-truncate"},[i("router-link",{staticClass:"text-reset",attrs:{to:"/media/"+t.media.media_id,title:t.$t("media.episode",{number:t.media.episode_number})+" ― "+t.media.name}},[t._v("\n          "+t._s(t.$t("media.episode",{number:t.media.episode_number}))+" ― "+t._s(t.media.name)+"\n        ")])],1)]),t._v(" "),t._t("default")],2),t._v(" "),i("media-card-context",{attrs:{position:t.contextMenuPosition,watched:t.watched,mediaId:t.media.media_id,seriesId:t.media.series_id,duration:t.media.duration},on:{beginUpdate:t.mediaBeginUpdate,updated:t.mediaUpdated},model:{value:t.showContextMenu,callback:function(e){t.showContextMenu=e},expression:"showContextMenu"}})],1)}),[],!1,null,"e63b62fa",null));e.a=p.exports},406:function(t,e,i){"use strict";i(401)},407:function(t,e,i){"use strict";i(403)},421:function(t,e,i){"use strict";var n=i(395),a={name:"toggle-queue-button",props:{seriesId:String,inQueue:Boolean},data:function(){return{loading:!1}},methods:{toggleQueue:function(){var t=this;this.loading=!0,this.$store.dispatch("media/toggleQueue",{seriesId:this.seriesId,inQueue:this.inQueue}).then((function(){t.$emit("toggle",t.endLoading)}))},endLoading:function(){this.loading=!1}},components:{Loading:n.a}},s=i(2),o=Object(s.a)(a,(function(){var t=this.$createElement,e=this._self._c||t;return this.loading?e("button",{staticClass:"btn btn-disabled btn-sm"},[e("loading")],1):e("button",{staticClass:"btn btn-primary btn-sm",on:{click:this.toggleQueue}},[this._v(this._s(this.inQueue?this.$t("media.queueRemove"):this.$t("media.queueAdd")))])}),[],!1,null,null,null);e.a=o.exports},428:function(t,e,i){},429:function(t,e,i){},441:function(t,e,i){"use strict";i(428)},442:function(t,e,i){"use strict";i(429)}}]);