(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{393:function(t,e,a){"use strict";a.r(e);a(20),a(15),a(21);var i=a(408),n=a(409),r=a(395),s=a(414),o=a(405),c=a(420);function u(t,e,a,i,n,r,s){try{var o=t[r](s),c=o.value}catch(t){return void a(t)}o.done?e(c):Promise.resolve(c).then(i,n)}function d(t){return function(){var e=this,a=arguments;return new Promise((function(i,n){var r=t.apply(e,a);function s(t){u(r,i,n,s,o,"next",t)}function o(t){u(r,i,n,s,o,"throw",t)}s(void 0)}))}}var l={name:"History",data:function(){return{mediaOptions:[{key:"anime",value:this.$t("media.types.anime")},{key:"drama",value:this.$t("media.types.drama")},{key:"anime|drama",value:this.$t("media.types.both")}],mediaType:null}},methods:{updateMediaList:function(){var t=this;return d(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("history/getHistory",t.mediaType.key);case 2:case"end":return e.stop()}}),e)})))()},loadMore:function(){var t=this;return d(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("history/loadMoreHistory",t.mediaType.key);case 2:case"end":return e.stop()}}),e)})))()}},mounted:function(){document.title="".concat(this.$t("navbar.history")," ― CR"),this.mediaType=this.mediaOptions[0]},components:{DropdownSelector:i.a,Checkbox:n.a,MediaCard:o.a,CompactMediaCard:c.a,Loading:r.a,LoadingSmall:s.a},computed:{mediaList:function(){return this.$store.state.history.history},loading:function(){return this.$store.state.history.loading},loadingMore:function(){return this.$store.state.history.loadingMore},canLoadMore:function(){return this.$store.state.history.canLoadMore},compact:{get:function(){return this.$store.state.media.displayCompact},set:function(t){this.$store.commit("media/setCompactDisplay",t)}},locale:function(){return this.$store.state.locale.locale}},watch:{mediaType:function(){this.updateMediaList()},locale:function(){this.updateMediaList()}}},m=a(2),p=Object(m.a)(l,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"row mb-2"},[a("dropdown-selector",{staticClass:"col-lg-3 col-md-4 col-sm-6 mb-2",attrs:{label:t.$t("media.media"),options:t.mediaOptions},model:{value:t.mediaType,callback:function(e){t.mediaType=e},expression:"mediaType"}}),t._v(" "),a("checkbox",{staticClass:"col-lg-3 col-md-4 col-sm-6 mb-2",attrs:{label:t.$t("media.compact")},model:{value:t.compact,callback:function(e){t.compact=e},expression:"compact"}}),t._v(" "),t.loading&&0!==t.mediaList.length?a("loading-small"):t._e()],1),t._v(" "),t.loading&&0===t.mediaList.length?a("loading"):a("div",{staticClass:"mb-4"},[t.mediaList.length?t._e():a("div",{staticClass:"alert alert-info bg-dark text-light"},[t._v("\n      "+t._s(t.$t("media.emptyHistory"))+"\n    ")]),t._v(" "),t.compact?a("div",{staticClass:"row"},t._l(t.mediaList,(function(t){return a("div",{key:t.media_id,staticClass:"col-12 mb-2"},[a("compact-media-card",{attrs:{media:t}})],1)})),0):a("div",{staticClass:"row"},t._l(t.mediaList,(function(t){return a("div",{key:t.media_id,staticClass:"col-lg-3 col-md-4 col-sm-6 offset-sm-0 col-8 offset-2 mb-4"},[a("media-card",{attrs:{media:t}})],1)})),0),t._v(" "),t.canLoadMore?a("div",[t.loadingMore?a("loading"):a("button",{staticClass:"btn btn-block btn-primary",on:{click:t.loadMore}},[t._v(t._s(t.$t("media.loadMore")))])],1):t._e()])],1)}),[],!1,null,null,null);e.default=p.exports},395:function(t,e,a){"use strict";var i={name:"loading",data:function(){return{count:5}}},n=(a(398),a(2)),r=Object(n.a)(i,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"spinner"},this._l(this.count,(function(t){return e("div",{key:t,class:"rect rect"+t})})),0)}),[],!1,null,"597d1897",null);e.a=r.exports},396:function(t,e,a){},397:function(t,e,a){},398:function(t,e,a){"use strict";a(396)},399:function(t,e,a){"use strict";var i={name:"card"},n=(a(400),a(2)),r=Object(n.a)(i,(function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"card bg-dark text-light"},[this._t("default")],2)}),[],!1,null,"2edc5dc4",null);e.a=r.exports},400:function(t,e,a){"use strict";a(397)},401:function(t,e,a){},402:function(t,e,a){"use strict";var i=a(1);e.a=new i.a},403:function(t,e,a){},404:function(t,e,a){"use strict";a(377);var i={name:"progress-bar",props:{value:Number}},n=a(2),r=Object(n.a)(i,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"progress rounded-0 bg-warning",staticStyle:{height:"4px"}},[e("div",{staticClass:"progress-bar bg-primary",style:{width:this.value+"%"},attrs:{role:"progressbar","aria-valuenow":this.value,"aria-valuemin":"0","aria-valuemax":"100"}})])}),[],!1,null,null,null);e.a=r.exports},405:function(t,e,a){"use strict";a(380),a(311);var i=a(404),n=a(399),r=(a(20),a(15),a(21),a(378),a(377),a(1)),s=a(379),o=a.n(s);function c(t,e,a,i,n,r,s){try{var o=t[r](s),c=o.value}catch(t){return void a(t)}o.done?e(c):Promise.resolve(c).then(i,n)}function u(t){return function(){var e=this,a=arguments;return new Promise((function(i,n){var r=t.apply(e,a);function s(t){c(r,i,n,s,o,"next",t)}function o(t){c(r,i,n,s,o,"throw",t)}s(void 0)}))}}r.a.use(o.a);var d={name:"media-card-context",props:{value:Boolean,position:{x:Number,y:Number},mediaId:String,seriesId:String,watched:Boolean,duration:Number},computed:{inQueue:function(){var t=this;return void 0!==this.$store.state.queue.queue.find((function(e){return e.series.series_id===t.seriesId}))}},methods:{close:function(){this.$emit("input",!1)},toggleWatched:function(){var t=this;return u(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.close(),t.$emit("beginUpdate"),e.next=4,t.$store.dispatch("media/setWatched",{mediaId:t.mediaId,watched:!t.watched,duration:t.duration});case 4:return e.next=6,t.$store.dispatch("media/updateMedia",t.mediaId);case 6:t.$emit("updated");case 7:case"end":return e.stop()}}),e)})))()},toggleQueue:function(){var t=this;return u(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.close(),t.$emit("beginUpdate"),e.next=4,t.$store.dispatch("media/toggleQueue",{seriesId:t.seriesId,inQueue:t.inQueue});case 4:return e.next=6,t.$store.dispatch("media/updateSeries",t.seriesId);case 6:return e.next=8,t.$store.dispatch("queue/getQueue");case 8:t.$emit("updated");case 9:case"end":return e.stop()}}),e)})))()}}},l=(a(406),a(2)),m=Object(l.a)(d,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.value?a("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:t.close,expression:"close"}],staticClass:"list-group position-absolute text-nowrap",style:{left:t.position.x+"px",top:t.position.y+"px"}},[a("a",{staticClass:"list-group-item list-group-item-action bg-dark text-light",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.toggleWatched(e)}}},[t._v("\n    "+t._s(t.watched?t.$t("media.markUnwatched"):t.$t("media.markWatched"))+"\n  ")]),t._v(" "),a("a",{staticClass:"list-group-item list-group-item-action bg-dark text-light",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.toggleQueue(e)}}},[t._v("\n    "+t._s(t.inQueue?t.$t("media.queueRemove"):t.$t("media.queueAdd"))+"\n  ")])]):t._e()}),[],!1,null,"3b8ea60a",null).exports,p=a(395),h=a(402),f={name:"media-card",props:{media:Object,active:Boolean},data:function(){return{showContextMenu:!1,contextMenuPosition:{x:0,y:0},loading:!1,cardHeight:0}},components:{ProgressBar:i.a,Card:n.a,MediaCardContext:m,Loading:p.a},created:function(){var t=this;h.a.$on("closeContextMenus",(function(){t.showContextMenu=!1}))},methods:{contextMenu:function(t){h.a.$emit("closeContextMenus"),this.showContextMenu=!0,this.contextMenuPosition.x=t.clientX-this.$refs.card.$el.getBoundingClientRect().left,this.contextMenuPosition.y=t.clientY-this.$refs.card.$el.getBoundingClientRect().top},mediaUpdated:function(){this.loading=!1},mediaBeginUpdate:function(){this.cardHeight=this.$refs.card.$el.getBoundingClientRect().height,this.loading=!0}},computed:{length:function(){return new Date(1e3*this.media.duration).toISOString().substr(11,8).replace(/^(00:)?0?/,"")},watchedTime:function(){return new Date(1e3*this.media.playhead).toISOString().substr(11,8).replace(/^(00:)?0?/,"")},watched:function(){return this.media.playhead>=.9*this.media.duration}}},v=(a(407),Object(l.a)(f,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.loading?a("card",{class:{"active-card":t.active},style:{height:t.cardHeight+"px"}},[a("loading",{staticClass:"my-auto"})],1):a("card",{ref:"card",class:{"active-card":t.active},nativeOn:{contextmenu:function(e){return e.preventDefault(),e.stopPropagation(),t.contextMenu(e)}}},[a("router-link",{staticClass:"text-reset embed-responsive embed-responsive-16by9",attrs:{to:"/media/"+t.media.media_id}},[t.media.screenshot_image?a("img",{staticClass:"card-img-top embed-responsive-item image",attrs:{src:t.$https(t.media.screenshot_image.large_url),alt:"Media Thumbnail"}}):t._e(),t._v(" "),a("div",{staticClass:"play"}),t._v(" "),t.watched?a("div",{staticClass:"watched-grey"}):t._e(),t._v(" "),t.watched?a("fa-icon",{staticClass:"watched",attrs:{icon:"eye"}}):t._e(),t._v(" "),a("span",{staticClass:"badge badge-secondary length"},[t._v(t._s(t.media.playhead>0&&!t.watched?t.watchedTime+" / ":"")+t._s(t.length))])],1),t._v(" "),a("progress-bar",{attrs:{value:t.media.playhead/t.media.duration*100}}),t._v(" "),a("div",{staticClass:"mx-2 my-1 d-flex flex-column"},[a("span",{staticClass:"text-truncate"},[a("router-link",{staticClass:"text-reset",attrs:{to:"/series/"+t.media.series_id,title:t.media.collection_name}},[t._v("\n          "+t._s(t.media.collection_name)+"\n        ")])],1),t._v(" "),a("small",{staticClass:"text-truncate"},[a("router-link",{staticClass:"text-reset",attrs:{to:"/media/"+t.media.media_id,title:t.$t("media.episode",{number:t.media.episode_number})+" ― "+t.media.name}},[t._v("\n          "+t._s(t.$t("media.episode",{number:t.media.episode_number}))+" ― "+t._s(t.media.name)+"\n        ")])],1)]),t._v(" "),t._t("default")],2),t._v(" "),a("media-card-context",{attrs:{position:t.contextMenuPosition,watched:t.watched,mediaId:t.media.media_id,seriesId:t.media.series_id,duration:t.media.duration},on:{beginUpdate:t.mediaBeginUpdate,updated:t.mediaUpdated},model:{value:t.showContextMenu,callback:function(e){t.showContextMenu=e},expression:"showContextMenu"}})],1)}),[],!1,null,"e63b62fa",null));e.a=v.exports},406:function(t,e,a){"use strict";a(401)},407:function(t,e,a){"use strict";a(403)},408:function(t,e,a){"use strict";a(28),a(38),a(39),a(40),a(41),a(42),a(37),a(43),a(44),a(15);function i(t,e){var a;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(a=function(t,e){if(!t)return;if("string"==typeof t)return n(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);"Object"===a&&t.constructor&&(a=t.constructor.name);if("Map"===a||"Set"===a)return Array.from(t);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return n(t,e)}(t))||e&&t&&"number"==typeof t.length){a&&(t=a);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,c=!1;return{s:function(){a=t[Symbol.iterator]()},n:function(){var t=a.next();return o=t.done,t},e:function(t){c=!0,s=t},f:function(){try{o||null==a.return||a.return()}finally{if(c)throw s}}}}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,i=new Array(e);a<e;a++)i[a]=t[a];return i}var r={name:"dropdown-selector",props:{options:Array,label:String,value:{key:String,value:String}},methods:{onChange:function(t){var e,a=i(this.options);try{for(a.s();!(e=a.n()).done;){var n=e.value;if(n.value===t.target.value){this.$emit("input",n);break}}}catch(t){a.e(t)}finally{a.f()}}}},s=a(2),o=Object(s.a)(r,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"input-group"},[a("div",{staticClass:"input-group-prepend"},[a("label",{staticClass:"input-group-text bg-dark text-light border-warning"},[t._v(t._s(t.label))])]),t._v(" "),a("select",{staticClass:"custom-select border-warning bg-secondary text-white",domProps:{value:t.value?t.value.value:""},on:{change:t.onChange}},t._l(t.options,(function(e){return a("option",{key:e.key},[t._v(t._s(e.value))])})),0)])}),[],!1,null,null,null);e.a=o.exports},409:function(t,e,a){"use strict";var i={name:"checkbox",props:{value:Boolean,label:String},methods:{input:function(t){this.$emit("input",t.target.checked)}}},n=a(2),r=Object(n.a)(i,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"input-group"},[e("div",{staticClass:"input-group-prepend"},[e("label",{staticClass:"input-group-text bg-dark border-warning text-light"},[this._v(this._s(this.label))])]),this._v(" "),e("div",{staticClass:"input-group-append"},[e("div",{staticClass:"input-group-text bg-warning border-warning"},[e("input",{attrs:{type:"checkbox"},domProps:{checked:this.value},on:{input:this.input}})])])])}),[],!1,null,null,null);e.a=r.exports},410:function(t,e,a){},414:function(t,e,a){"use strict";var i={name:"loading-small",data:function(){return{count:10}}},n=(a(415),a(2)),r=Object(n.a)(i,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"sk-fading-circle"},this._l(this.count,(function(t){return e("div",{key:t,class:"sk-circle sk-circle"+t})})),0)}),[],!1,null,"57ca1db3",null);e.a=r.exports},415:function(t,e,a){"use strict";a(410)},420:function(t,e,a){"use strict";a(377);var i=a(399),n=a(404),r={name:"compact-series-card",props:{media:{media_id:String,name:String,playhead:Number,duration:Number}},components:{Card:i.a,ProgressBar:n.a}},s=a(2),o=Object(s.a)(r,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("card",[a("div",{staticClass:"d-flex flex-row align-items-center"},[t._t("default"),t._v(" "),a("router-link",{staticClass:"text-reset overflow-hidden",attrs:{to:"/media/"+t.media.media_id,title:t.media.name}},[a("div",{staticClass:"mx-4 my-2 text-truncate"},[t._v("\n        "+t._s(t.$t("media.episode",{number:t.media.episode_number}))+": "+t._s(t.media.name)+" - "+t._s(this.media.collection_name)+"\n      ")])])],2),t._v(" "),a("progress-bar",{attrs:{value:t.media.playhead/t.media.duration*100}})],1)}),[],!1,null,null,null);e.a=o.exports}}]);